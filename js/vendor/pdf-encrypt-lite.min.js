/* esm.sh - @pdfsmaller/pdf-encrypt-lite@1.0.1 */
import*as __0$ from"/pdf-lib@^1.17.1?target=es2022";var require=n=>{const e=m=>typeof m.default<"u"?m.default:m,c=m=>Object.assign({__esModule:true},m);switch(n){case"pdf-lib":return c(__0$);default:console.error('module "'+n+'" not found');return null;}};
var Z=Object.create;var j=Object.defineProperty;var K=Object.getOwnPropertyDescriptor;var tt=Object.getOwnPropertyNames;var et=Object.getPrototypeOf,nt=Object.prototype.hasOwnProperty;var st=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,s)=>(typeof require<"u"?require:t)[s]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var rt=(e,t)=>()=>(e&&(t=e(e=0)),t);var M=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),ct=(e,t)=>{for(var s in t)j(e,s,{get:t[s],enumerable:!0})},C=(e,t,s,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of tt(t))!nt.call(e,r)&&r!==s&&j(e,r,{get:()=>t[r],enumerable:!(n=K(t,r))||n.enumerable});return e};var q=(e,t,s)=>(s=e!=null?Z(et(e)):{},C(t||!e||!e.__esModule?j(s,"default",{value:e,enumerable:!0}):s,e)),xt=e=>C(j({},"__esModule",{value:!0}),e);var G={};ct(G,{RC4:()=>k,bytesToHex:()=>ot,hexToBytes:()=>ft,md5:()=>it});function it(e){let t=typeof e=="string"?new TextEncoder().encode(e):e,s=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],n=new Uint32Array([3614090360,3905402710,606105819,3250441966,4118548399,1200080426,2821735955,4249261313,1770035416,2336552879,4294925233,2304563134,1804603682,4254626195,2792965006,1236535329,4129170786,3225465664,643717713,3921069994,3593408605,38016083,3634488961,3889429448,568446438,3275163606,4107603335,1163531501,2850285829,4243563512,1735328473,2368359562,4294588738,2272392833,1839030562,4259657740,2763975236,1272893353,4139469664,3200236656,681279174,3936430074,3572445317,76029189,3654602809,3873151461,530742520,3299628645,4096336452,1126891415,2878612391,4237533241,1700485571,2399980690,4293915773,2240044497,1873313359,4264355552,2734768916,1309151649,4149444226,3174756917,718787259,3951481745]),r=1732584193,c=4023233417,x=2562383102,i=271733878,b=t.length,g=b*8,l=b+9+63&-64,y=new Uint8Array(l);y.set(t),y[b]=128;let A=new DataView(y.buffer);A.setUint32(l-8,g,!0),A.setUint32(l-4,0,!0);for(let U=0;U<l;U+=64){let p=new Uint32Array(y.buffer,U,16),h=r,o=c,a=x,d=i;for(let f=0;f<64;f++){let u,w;f<16?(u=o&a|~o&d,w=f):f<32?(u=d&o|~d&a,w=(5*f+1)%16):f<48?(u=o^a^d,w=(3*f+5)%16):(u=a^(o|~d),w=7*f%16),u=u+h+n[f]+p[w]>>>0,h=d,d=a,a=o,o=o+(u<<s[f]|u>>>32-s[f])>>>0}r=r+h>>>0,c=c+o>>>0,x=x+a>>>0,i=i+d>>>0}let D=new Uint8Array(16),F=new DataView(D.buffer);return F.setUint32(0,r,!0),F.setUint32(4,c,!0),F.setUint32(8,x,!0),F.setUint32(12,i,!0),D}function ft(e){let t=new Uint8Array(e.length/2);for(let s=0;s<t.length;s++)t[s]=parseInt(e.substr(s*2,2),16);return t}function ot(e){return Array.from(e).map(t=>t.toString(16).padStart(2,"0")).join("")}var k,$=rt(()=>{k=class{constructor(t){this.s=new Uint8Array(256),this.i=0,this.j=0;for(let n=0;n<256;n++)this.s[n]=n;let s=0;for(let n=0;n<256;n++)s=s+this.s[n]+t[n%t.length]&255,[this.s[n],this.s[s]]=[this.s[s],this.s[n]]}process(t){let s=new Uint8Array(t.length);for(let n=0;n<t.length;n++){this.i=this.i+1&255,this.j=this.j+this.s[this.i]&255,[this.s[this.i],this.s[this.j]]=[this.s[this.j],this.s[this.i]];let r=this.s[this.i]+this.s[this.j]&255;s[n]=t[n]^this.s[r]}return s}}});var Q=M(m=>{var{PDFDocument:at,PDFName:W,PDFHexString:E,PDFString:dt,PDFDict:Y,PDFArray:lt,PDFRawStream:ht,PDFNumber:O}=st("pdf-lib"),{md5:P,RC4:I,hexToBytes:_,bytesToHex:S}=($(),xt(G)),T=new Uint8Array([40,191,78,94,78,117,138,65,100,0,78,86,255,250,1,8,46,46,0,182,208,104,62,128,47,12,169,254,100,83,105,122]);function V(e){let t=new TextEncoder().encode(e),s=new Uint8Array(32);return t.length>=32?s.set(t.slice(0,32)):(s.set(t),s.set(T.slice(0,32-t.length),t.length)),s}function z(e,t,s,n){let r=V(e),c=new Uint8Array(r.length+t.length+4+n.length),x=0;c.set(r,x),x+=r.length,c.set(t,x),x+=t.length,c[x++]=s&255,c[x++]=s>>8&255,c[x++]=s>>16&255,c[x++]=s>>24&255,c.set(n,x);let i=P(c);for(let b=0;b<50;b++)i=P(i.slice(0,16));return i.slice(0,16)}function J(e,t){let s=V(e||t),n=P(s);for(let x=0;x<50;x++)n=P(n);let r=V(t),c=new Uint8Array(r);for(let x=0;x<20;x++){let i=new Uint8Array(n.length);for(let g=0;g<n.length;g++)i[g]=n[g]^x;c=new I(i.slice(0,16)).process(c)}return c}function N(e,t){let s=new Uint8Array(T.length+t.length);s.set(T),s.set(t,T.length);let n=P(s),c=new I(e).process(n);for(let i=1;i<=19;i++){let b=new Uint8Array(e.length);for(let l=0;l<e.length;l++)b[l]=e[l]^i;c=new I(b).process(c)}let x=new Uint8Array(32);return x.set(c),x.set(new Uint8Array(16),16),x}function H(e,t,s,n){let r=new Uint8Array(n.length+5);r.set(n),r[n.length]=t&255,r[n.length+1]=t>>8&255,r[n.length+2]=t>>16&255,r[n.length+3]=s&255,r[n.length+4]=s>>8&255;let c=P(r);return new I(c.slice(0,Math.min(n.length+5,16))).process(e)}function R(e,t,s,n){if(e){if(e instanceof dt){let r=e.asBytes(),c=H(r,t,s,n);e.value=S(c)}else if(e instanceof E){let r=_(e.asString()),c=H(r,t,s,n);e.value=S(c)}else if(e instanceof Y){let r=e.entries();for(let[c,x]of r){let i=c.asString();i!=="/Length"&&i!=="/Filter"&&i!=="/DecodeParms"&&R(x,t,s,n)}}else if(e instanceof lt){let r=e.asArray();for(let c of r)R(c,t,s,n)}}}async function bt(e,t,s=null){try{let n=await at.load(e,{ignoreEncryption:!0,updateMetadata:!1}),r=n.context,c,x=r.trailerInfo,i=x.ID;if(i&&Array.isArray(i)&&i.length>0){let h=i[0].toString().replace(/^<|>$/g,"");c=_(h)}else{let p=new Uint8Array(16);if(typeof crypto<"u"&&crypto.getRandomValues)crypto.getRandomValues(p);else for(let a=0;a<16;a++)p[a]=Math.floor(Math.random()*256);c=p;let h=E.of(S(c)),o=E.of(S(c));x.ID=[h,o]}let b=4294967292,g=J(s,t),l=z(t,g,b,c),y=N(l,c),A=r.enumerateIndirectObjects();for(let[p,h]of A){let o=p.objectNumber,a=p.generationNumber||0;if(h instanceof Y){let d=h.get(W.of("Filter"));if(d&&d.asString()==="/Standard")continue}if(h instanceof ht){let d=h.contents,f=H(d,o,a,l);h.contents=f}R(h,o,a,l)}let D=r.obj({Filter:W.of("Standard"),V:O.of(2),R:O.of(3),Length:O.of(128),P:O.of(b),O:E.of(S(g)),U:E.of(S(y))}),F=r.register(D);return x.Encrypt=F,await n.save({useObjectStreams:!1})}catch(n){throw console.error("PDF encryption error:",n),new Error(`Failed to encrypt PDF: ${n.message}`)}}m.padPassword=V;m.computeEncryptionKey=z;m.computeOwnerKey=J;m.computeUserKey=N;m.encryptObject=H;m.encryptStringsInObject=R;m.encryptPDF=bt});var X=M(B=>{function ut(e){let t=typeof e=="string"?new TextEncoder().encode(e):e,s=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],n=new Uint32Array([3614090360,3905402710,606105819,3250441966,4118548399,1200080426,2821735955,4249261313,1770035416,2336552879,4294925233,2304563134,1804603682,4254626195,2792965006,1236535329,4129170786,3225465664,643717713,3921069994,3593408605,38016083,3634488961,3889429448,568446438,3275163606,4107603335,1163531501,2850285829,4243563512,1735328473,2368359562,4294588738,2272392833,1839030562,4259657740,2763975236,1272893353,4139469664,3200236656,681279174,3936430074,3572445317,76029189,3654602809,3873151461,530742520,3299628645,4096336452,1126891415,2878612391,4237533241,1700485571,2399980690,4293915773,2240044497,1873313359,4264355552,2734768916,1309151649,4149444226,3174756917,718787259,3951481745]),r=1732584193,c=4023233417,x=2562383102,i=271733878,b=t.length,g=b*8,l=b+9+63&-64,y=new Uint8Array(l);y.set(t),y[b]=128;let A=new DataView(y.buffer);A.setUint32(l-8,g,!0),A.setUint32(l-4,0,!0);for(let U=0;U<l;U+=64){let p=new Uint32Array(y.buffer,U,16),h=r,o=c,a=x,d=i;for(let f=0;f<64;f++){let u,w;f<16?(u=o&a|~o&d,w=f):f<32?(u=d&o|~d&a,w=(5*f+1)%16):f<48?(u=o^a^d,w=(3*f+5)%16):(u=a^(o|~d),w=7*f%16),u=u+h+n[f]+p[w]>>>0,h=d,d=a,a=o,o=o+(u<<s[f]|u>>>32-s[f])>>>0}r=r+h>>>0,c=c+o>>>0,x=x+a>>>0,i=i+d>>>0}let D=new Uint8Array(16),F=new DataView(D.buffer);return F.setUint32(0,r,!0),F.setUint32(4,c,!0),F.setUint32(8,x,!0),F.setUint32(12,i,!0),D}var v=class{constructor(t){this.s=new Uint8Array(256),this.i=0,this.j=0;for(let n=0;n<256;n++)this.s[n]=n;let s=0;for(let n=0;n<256;n++)s=s+this.s[n]+t[n%t.length]&255,[this.s[n],this.s[s]]=[this.s[s],this.s[n]]}process(t){let s=new Uint8Array(t.length);for(let n=0;n<t.length;n++){this.i=this.i+1&255,this.j=this.j+this.s[this.i]&255,[this.s[this.i],this.s[this.j]]=[this.s[this.j],this.s[this.i]];let r=this.s[this.i]+this.s[this.j]&255;s[n]=t[n]^this.s[r]}return s}};function gt(e){let t=new Uint8Array(e.length/2);for(let s=0;s<t.length;s++)t[s]=parseInt(e.substr(s*2,2),16);return t}function yt(e){return Array.from(e).map(t=>t.toString(16).padStart(2,"0")).join("")}B.md5=ut;B.hexToBytes=gt;B.bytesToHex=yt;B.RC4=v});var Ft=q(Q(),1),L=q(X(),1);var mt="1.0.0",At="https://pdfsmaller.com",Dt="PDFSmaller.com";var export_RC4=L.RC4;var export_bytesToHex=L.bytesToHex;var export_encryptPDF=Ft.encryptPDF;var export_hexToBytes=L.hexToBytes;var export_md5=L.md5;export{At as HOMEPAGE,Dt as POWERED_BY,export_RC4 as RC4,mt as VERSION,export_bytesToHex as bytesToHex,export_encryptPDF as encryptPDF,export_hexToBytes as hexToBytes,export_md5 as md5};
/*! Bundled license information:

@pdfsmaller/pdf-encrypt-lite/dist/crypto-minimal.mjs:
@pdfsmaller/pdf-encrypt-lite/dist/crypto-minimal.js:
  (**
   * pdf-encrypt-lite - Ultra-lightweight PDF encryption library
   * Powers PDFSmaller.com's PDF encryption tool
   * 
   * @author PDFSmaller.com (https://pdfsmaller.com)
   * @license MIT
   * @see https://pdfsmaller.com/protect-pdf - Try it online!
   * 
   * This minimal cryptographic implementation was built to solve the "impossible" 
   * problem of real PDF encryption within Cloudflare Workers' 1MB limit.
   * Total size: ~7KB for complete PDF encryption!
   *)

@pdfsmaller/pdf-encrypt-lite/dist/pdf-encrypt.js:
  (**
   * pdf-encrypt-lite - Ultra-lightweight PDF encryption library
   * Powers PDFSmaller.com's PDF encryption tool
   * 
   * @author PDFSmaller.com (https://pdfsmaller.com)
   * @license MIT
   * @see https://pdfsmaller.com/protect-pdf - Try it online!
   * 
   * This module implements PDF Standard Security Handler (Algorithm 2 & 3 from PDF spec)
   * Built to solve the "impossible" problem of real PDF encryption within edge constraints
   * 
   * Total size with crypto: ~7KB - when others are 2-20MB!
   * Battle-tested on thousands of PDFs at PDFSmaller.com
   *)

@pdfsmaller/pdf-encrypt-lite/dist/index.mjs:
  (**
   * pdf-encrypt-lite - Ultra-lightweight PDF encryption library (7KB!)
   * 
   * Built by PDFSmaller.com - Your free PDF toolkit
   * Try it online at https://pdfsmaller.com/protect-pdf
   * 
   * @author PDFSmaller.com (https://pdfsmaller.com)
   * @license MIT
   * 
   * Why we built this:
   * - Existing libraries are 2-20MB (too large for edge environments)
   * - Cloudflare Workers has a 1MB limit
   * - We needed real PDF encryption that actually works
   * - Everyone said it was impossible... we proved them wrong!
   * 
   * Features:
   * - Real RC4 128-bit encryption
   * - Only ~7KB total size
   * - Works in browsers and edge environments
   * - PDF Standard compliant
   * - Zero dependencies (except pdf-lib)
   * 
   * This is the exact same encryption engine that powers PDFSmaller.com!
   * Battle-tested on thousands of PDFs daily.
   * 
   * @example
   * import { encryptPDF } from 'pdf-encrypt-lite';
   * 
   * const encryptedPdf = await encryptPDF(pdfBytes, 'password123');
   * 
   * // With separate owner password
   * const encryptedPdf = await encryptPDF(pdfBytes, 'user123', 'owner456');
   * 
   * @see https://pdfsmaller.com - Free PDF tools powered by this library
   * @see https://github.com/pdfsmaller/pdf-encrypt-lite - GitHub repo
   *)
*/
//# sourceMappingURL=pdf-encrypt-lite.mjs.map